@using System.Collections.Generic;
@using Nike.Models;
@{
    List<Giohang> list = (List<Giohang>)Session["Giohang"] as List<Giohang>;
    QuanLySanPhamEntities _db = new QuanLySanPhamEntities();
}


<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <link rel="icon" type="image/png" sizes="32x32" href="~/Assets/img/shopeeicon.png">

    <link rel="stylesheet" href="~/Assets/Css/base.css" />
    <link rel="stylesheet" href="~/Assets/Css/main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    @{
        KhachHang khsession = (KhachHang)Session["Taikhoan"];
        KhachHang kh;
        if (khsession != null)
        {
            kh = _db.KhachHangs.Find(khsession.idUser);
        }
        else { kh = null; }



    }
    <div class="app">
        <header class="header">
            <div class="grid">
                <nav class="navbar">
                    <ul class="navbar__list">
                        <li class="navbar__item navbar__item--separate navbar__has-qr">
                            Vào cửa hàng trên ứng dụng
                            <div class="navbar__qr">
                                <img src="/assets/img/qr_code.png" alt="QR code" class="navbar__qr-img">
                                <div class="navbar__qr-apps">
                                    <a href="" class="navbar__qr-link">
                                        <img src="/assets/img/google_play.png" alt="Google Play"
                                             class="navbar__qr-download-img">
                                    </a>
                                    <a href="" class="navbar__qr-link">
                                        <img src="/assets/img/app_store.png" alt="App Store"
                                             class="navbar__qr-download-img">
                                    </a>
                                </div>
                            </div>

                        </li>
                        <li class="navbar__item">
                            <span class="navbar__title--no-pointer">Kết nối</span>
                            <a href="https://www.facebook.com/ttnhan12" class="navbar__icon-link"><i class="navbar__icon fa-brands fa-facebook"></i></a>
                            <a href="https://www.instagram.com/tnhannn___/" class="navbar__icon-link"><i class="navbar__icon fa-brands fa-instagram"></i></a>
                        </li>
                    </ul>
                    <ul class="navbar__list">
                        @if (kh != null)
                        {
                            <li class="navbar__item navbar__has-notify">
                                <a href="" class="navbar__item-link">
                                    <i class="navbar__icon fa-solid fa-bell"></i>Thông báo
                                </a>
                                <div class="navbar__notify">
                                    <header class="navbar__notify-header">
                                        <h3>Thông báo mới nhận</h3>
                                    </header>
                                    <ul class="navbar__notify-list">
                                        <li class="navbar__notify-item navbar__notify-item--viewed">
                                            <a href="" class="navbar__notify-link">
                                                <img src="https://cf.shopee.vn/file/55ed967c18d72116312573fd31469511_tn"
                                                     alt="" class="navbar__notify-img">
                                                <div class="navbar__notify-info">
                                                    <span class="navbar__notify-name"> Chia sẻ nhận xét về sản phẩm </span>
                                                    <span class="navbar__notify-desc">
                                                        Đơn hàng 220212AAW97S32 đã hoàn thành.
                                                        Bạn hãy đánh giá sản phẩm trước ngày xu và giúp người dùng khác hiểu
                                                        hơn về sản phẩm nhé!
                                                    </span>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                    <footer class="navbar_notify-footer">
                                        <a href="" class="navbar_notify-footer-btn">Xem tất cả</a>
                                    </footer>
                                </div>
                            </li>
                        }
                        <li class="navbar__item">
                            <a href="" class="navbar__item-link">
                                <i class="navbar__icon fa-solid fa-circle-question"></i>Trợ giúp
                            </a>
                        </li>

                        @{if (kh != null)
                            {
                                <li class="navbar__item navbar__item-user">
                                    @{ if (kh.Picture != null)
                                        {
                                            <img src="~/Hinh/KhachHang/@Url.Content(kh.Picture)"
                                                 alt="" class="navbar__item-user-avt">
                                        }
                                        else
                                        {
                                            <img src="" alt="" class="navbar__item-user-avt">
                                        }
                                    }
                                    <span class="navbar__item-user-name"> @kh.FullName()</span>
                                    <ul class="navbar__item-user-menu">
                                        <li class="navbar__item-user-item">
                                            <a href="@Url.Action("Profile","Account")"> Tài khoản của tôi</a>
                                        </li>
                                        <li class="navbar__item-user-item">
                                            <a href="@Url.Action("ChangePassword","Account" ,new { idUser = kh.idUser }) ">Đổi mật khẩu</a>
                                        </li>
                                        <li class="navbar__item-user-item">
                                            <a href="@Url.Action("OrderList","Account")">Đơn mua</a>
                                        </li>
                                        <li class="navbar__item-user-item">
                                            <a href="@Url.Action("Logout","Account")" class="btn btn-warning">Đăng xuất</a>
                                        </li>

                                    </ul>
                                </li>
                            }
                            else
                            {
                                <li class="navbar__item navbar__item--strong navbar__item--separate">
                                    @Html.ActionLink("Đăng ký", "Register", "Account", null, new { @class = "navbar__item navbar__item--strong" })

                                </li>
                                <li class="navbar__item navbar__item--strong">
                                    @Html.ActionLink("Đăng nhập", "Login", "Account", null, new { @class = "navbar__item navbar__item--strong" })
                                </li>
                            }

                        }


                    </ul>
                </nav>
                <!-- Header Search -->
                <div class="header-search">
                    <div class="header-search__logo">
                        <a href="~/Home">
                            <img src="~/Hinh/logo.png" class="header-search__logo-img" />
                        </a>
                    </div>

                    @using (Html.BeginForm("Index", "Home", FormMethod.Get, new { @class = "header-search__box-search" }))
                    {
                        <div class="header-search__box-search-wrap">
                            @Html.TextBox("sort", null, new { @class = "header-search__box-search-input", @placeholder = "Tìm kiếm sản phẩm" })
                        </div>


                        <button class="header-search__box-search-btn" onclick="location.href='@Url.Action("Index", "Home")'">
                            <i class="header-search__box-search-btn-icon fa-solid fa-magnifying-glass"></i>
                        </button>
                    }

                    @{int TongSoLuong()
                        {
                            int iTongSoLuong = 0;
                            List<Giohang> listGiohang = Session["Giohang"] as List<Giohang>;
                            if (listGiohang != null)
                            {
                                iTongSoLuong = listGiohang.Sum(n => n.SoLuong);
                            }
                            return iTongSoLuong;
                        }
                        ViewBag.TongSoLuong = TongSoLuong();
                    }
                    <div class="header-search__cart">
                        <i class="header-search__cart-icon fa-solid fa-cart-shopping"></i>
                        <span class="header__cart-notice">@ViewBag.TongSoLuong</span>
                        @{if (list != null)
                            {
                                if (list.Count != 0)
                                {
                                    <div class="header-search__cart-list">
                                        <h4 class="header__cart-heading">Sản phẩm đã thêm</h4>

                                        <ul class="header__cart-list-item">
                                            <!-- cart-item -->
                                            @foreach (var item in list)
                                            {
                                                <li class="header__cart-item">
                                                    <img src="~/Hinh/@Url.Content(@item.Picture)" alt="" class="header__cart-img">
                                                    <div class="header__cart-item-info">
                                                        <div class="header__cart-item-head">
                                                            <h5 class="header__cart-item-name">@item.ProductName</h5>
                                                            <div class="header__cart-item-price-wrap">
                                                                <span class="header__cart-item-price">@string.Format("{0:#,0}", item.Price)</span>
                                                                <span class="header__cart-item-multiply">x</span>
                                                                <span class="header__cart-item-qty">@item.SoLuong</span>
                                                            </div>
                                                        </div>
                                                        <div class="header__cart-item-body">
                                                            <span class="header__cart-item-description">Phân loại: @item.Brand</span>
                                                            @Html.ActionLink("Xóa", "Xoagiohang", "Giohang", new { @Idproduct = item.IdProduct }, new { @class = "header__cart-item-remove" })

                                                        </div>
                                                    </div>
                                                </li>
                                            }
                                        </ul>


                                        <button class="btn btn--primary header__cart-view-cart"
                                                onclick="location.href='@Url.Action("Index", "Giohang")'">
                                            Xem giỏ hàng
                                        </button>
                                    </div>
                                }
                                else
                                {
                                    <div class="header-search__cart-list header-search__cart-list--no-card">
                                        <img src="https://foodhub.vn/assets/images/no-cart.png" alt=""
                                             class="header-search__no-cart-img">
                                        <div class="header-search__cart-list-no-cart-msg">Chưa có sản phẩm</div>
                                    </div>
                                }

                            }
                            else
                            {
                                <div class="header-search__cart-list header-search__cart-list--no-card">
                                    <img src="https://foodhub.vn/assets/images/no-cart.png" alt=""
                                         class="header-search__no-cart-img">
                                    <div class="header-search__cart-list-no-cart-msg">Chưa có sản phẩm</div>
                                </div>

                            }
                        }

                    </div>



                </div>
            </div>

        </header>

        @RenderBody()

        <footer class="footer">
            <div class="grid">

                <div class="grid__row">
                    <div class="grid__column-2-5">
                        <h3 class="footer__heading">Chăm sóc khách hàng</h3>
                        <ul class="footer__list">
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Trung tâm trợ giúp</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Shopee mall</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Hướng dẫn mua hàng</a>
                            </li>
                        </ul>
                    </div>
                    <div class="grid__column-2-5">
                        <h3 class="footer__heading">Giới thiệu</h3>
                        <ul class="footer__list">
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Giới thiệu</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Tuyển dụng</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Điều khoản</a>
                            </li>
                        </ul>
                    </div>
                    <div class="grid__column-2-5">
                        <h3 class="footer__heading">Danh mục</h3>
                        <ul class="footer__list">
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Apple</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Samsung</a>
                            </li>
                            <li class="footer__list-item">
                                <a href="" class="footer__list-item-link">Oppo</a>
                            </li>
                        </ul>
                    </div>
                    <div class="grid__column-2-5">
                        <h3 class="footer__heading">Theo dõi chúng tôi</h3>
                        <ul class="social_media">
                            <li style="--i:#5599ff;--j: #51dcff;">
                                <span class="icon"><i class="fab fa-facebook"></i></span>
                                <a href="https://www.facebook.com/ttnhan12" class="titulo">Facebook</a>
                            </li>
                            <li style="--i:#a955ff;--j: #ea51ff;">
                                <span class="icon"><i class="fab fa-instagram"></i></span>
                                <a href="https://www.instagram.com/tnhannn___/" class="titulo">Instagram</a>
                            </li>
                            <li style="--i:#7455ff;--j: #a251ff;">
                                <span class="icon"><i class="fab fa-linkedin"></i></span>
                                <span class="titulo">Linkedin</span>
                            </li>
                        </ul>
                    </div>

                    <div class="grid__column-2-5">
                        <h3 class="footer__heading">Vào cửa hàng trên ứng dụng</h3>
                        <div class="footer__download">
                            <img src="/assets/img/qr_code.png" alt="Download QR" class="footer_download-qr">
                            <div class="footer__download-apps">
                                <a href="" class="footer__download-apps-link">
                                    <img src="/assets/img/google_play.png" alt="Google play" class="footer__download-app-img">
                                </a>
                                <a href="" class="footer__download-apps-link">
                                    <img src="/assets/img/app_store.png" alt="App store" class="footer__download-app-img">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="footer__bottom">
                    <div class="grid">
                        <p class="footer__text">© 2023 - Bản quyền thuộc về HUFLIT</p>
                    </div>
                </div>

            </div>
        </footer>
    </div>

    <div class="modal">
        <div class="modal__overlay">

        </div>
        <div class="modal__body">
            <h1>Đã thêm sản phẩm vào giỏ hàng thành công</h1>
            <button class="btnbtn--primary" tabindex="1" style="display: inline-block;">OK</button>
        </div>

    </div>

    <script src="/Scripts/jquery-3.4.1.js"></script>
    <script src="/Scripts/bootstrap.js"></script>
    @*<script>
            $(".btn-order").click(function () {
                $(".modal").show();
            });
        </script>*@
</body>
</html>
